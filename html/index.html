<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Modora Report</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div id="app" class="modora-app hidden">
        <div class="modora-modal-backdrop" data-action="close" aria-label="Close"></div>
        <div class="modora-card" role="dialog" aria-labelledby="report-title" aria-modal="true">
            <div class="modora-card-header">
                <button type="button" class="modora-close-btn" id="btnClose" aria-label="Close">Ã—</button>
                <h1 id="report-title" class="modora-label" style="font-size: var(--modora-text-lg); margin-bottom: 4px;">Report</h1>
                <p id="report-subtitle" class="modora-helper" style="margin: 0;">Submit a report to staff</p>
                <p id="serverName" class="modora-helper" style="margin-top: 8px; margin-bottom: 0;"></p>
            </div>
            <div class="modora-card-body">
                <!-- State: loading -->
                <div id="stateLoading" class="modora-loading-block">
                    <div class="modora-spinner"></div>
                    <p>Loading...</p>
                </div>
                <!-- State: form -->
                <div id="stateForm" class="hidden">
                    <p id="reportIntroText" class="modora-helper hidden" style="margin-bottom: 12px;"></p>
                    <div id="formError" class="modora-toast modora-toast-error hidden" role="alert"></div>
                    <div id="cooldownNotice" class="modora-toast modora-toast-error hidden" role="status"></div>
                    <form id="reportForm" novalidate>
                        <div class="modora-form-section">
                            <label class="modora-label" for="category">Category *</label>
                            <select id="category" class="modora-select modora-input" required aria-required="true">
                                <option value="">Select category...</option>
                                <option value="scam">Scam</option>
                                <option value="harassment">Harassment</option>
                                <option value="exploit">Exploit</option>
                                <option value="cheating">Cheating</option>
                                <option value="other">Other</option>
                            </select>
                            <span id="categoryError" class="modora-error hidden" role="alert"></span>
                        </div>
                        <div class="modora-form-section">
                            <label class="modora-label" for="subject">Title *</label>
                            <input type="text" id="subject" class="modora-input" placeholder="Short summary (max 80 characters)" maxlength="80" required aria-required="true">
                            <span id="subjectError" class="modora-error hidden" role="alert"></span>
                            <span class="modora-char-count"><span id="subjectCount">0</span>/80</span>
                        </div>
                        <div class="modora-form-section">
                            <label class="modora-label" for="description">Description *</label>
                            <textarea id="description" class="modora-textarea" placeholder="Describe what happened (min 20, max 2000 characters)..." minlength="20" maxlength="2000" rows="5" required aria-required="true"></textarea>
                            <span id="descriptionError" class="modora-error hidden" role="alert"></span>
                            <span class="modora-char-count"><span id="descriptionCount">0</span>/2000</span>
                        </div>
                        <div class="modora-form-section">
                            <label class="modora-label">Evidence (optional)</label>
                            <div class="modora-helper">Add links or take an in-game screenshot</div>
                            <div id="evidenceList" class="modora-evidence-list"></div>
                            <div style="margin-top: 8px; display: flex; gap: 8px; flex-wrap: wrap;">
                                <button type="button" id="btnAddEvidence" class="modora-btn modora-btn-ghost">+ Add URL</button>
                                <button type="button" id="btnTakeScreenshot" class="modora-btn modora-btn-ghost">ðŸ“· Take screenshot</button>
                            </div>
                        </div>
                        <div id="nearbySection" class="modora-form-section hidden">
                            <label class="modora-label">Reported player(s) (optional)</label>
                            <div id="nearbyPlayers" class="modora-nearby-box"></div>
                        </div>
                        <div class="modora-form-actions">
                            <button type="button" id="btnCancel" class="modora-btn modora-btn-ghost">Cancel</button>
                            <button type="submit" id="btnSubmit" class="modora-btn modora-btn-primary">Submit Report</button>
                        </div>
                    </form>
                </div>
                <!-- State: success -->
                <div id="stateSuccess" class="modora-success-block hidden">
                    <div class="modora-success-icon" aria-hidden="true">âœ“</div>
                    <h2 style="font-size: var(--modora-text-lg); margin: 0;">Report sent</h2>
                    <p id="successMessage" style="color: var(--modora-text-muted); margin: 0;"></p>
                    <a id="ticketLink" class="modora-btn modora-btn-primary hidden" href="#" target="_blank" rel="noopener">View ticket</a>
                    <button type="button" id="btnCloseSuccess" class="modora-btn modora-btn-primary">Close</button>
                </div>
            </div>
            <div class="modora-card-footer">
                Reports are reviewed by staff. Do not abuse; rate limits apply.
            </div>
        </div>
    </div>
    <script src="app.js"></script>
</body>
</html>
